<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>网盘系统</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }

        /* 模态框样式 */
        .modal {
            transition: opacity 0.3s ease, transform 0.3s ease;
            transform: scale(0.9);
            opacity: 0;
        }

        .modal.active {
            transform: scale(1);
            opacity: 1;
        }

        /* 按钮悬停效果 */
        button:hover {
            transform: scale(1.05);
            transition: transform 0.2s ease;
        }

        /* 文件项样式 */
        .file-item {
            transition: background-color 0.2s ease;
        }

        .file-item:hover {
            background-color: #f3f4f6;
        }

        /* 聊天消息样式 */
        #chat-messages div {
            padding: 8px;
            border-radius: 4px;
            margin-bottom: 4px;
        }

        /* 自定义滚动条样式 */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }

        ::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #555;
        }

        /* 上传进度条样式 */
        .progress-bar {
            width: 100%;
            background-color: #f3f4f6;
            border-radius: 4px;
            overflow: hidden;
        }

        .progress {
            height: 20px;
            background-color: #3b82f6;
            width: 0%;
            text-align: center;
            line-height: 20px;
            color: white;
            border-radius: 4px;
        }
    </style>
</head>

<body class="bg-gray-100">
    <!-- 导航栏 -->
    <nav class="bg-gradient-to-r from-blue-600 to-indigo-600 p-4 text-white flex justify-between items-center shadow-md">
        <h1 class="text-2xl font-bold">网盘系统</h1>
        <div id="nav-actions" class="flex space-x-4">
            <button id="login-btn" class="bg-white bg-opacity-20 hover:bg-opacity-30 text-white py-2 px-4 rounded-md">登录</button>
            <button id="register-btn" class="bg-white bg-opacity-20 hover:bg-opacity-30 text-white py-2 px-4 rounded-md">注册</button>
        </div>
    </nav>

    <!-- 登录和注册模态框 -->
    <div id="login-modal" class="fixed top-0 left-0 w-full h-full bg-gray-900 bg-opacity-50 hidden justify-center items-center">
        <div class="modal bg-white p-8 rounded-md shadow-lg w-96">
            <h2 class="text-2xl font-bold mb-4 text-center text-blue-600">登录</h2>
            <input type="text" id="login-username" placeholder="用户名" class="border border-gray-300 p-2 mb-2 w-full rounded-md focus:ring-blue-500 focus:border-blue-500">
            <input type="password" id="login-password" placeholder="密码" class="border border-gray-300 p-2 mb-2 w-full rounded-md focus:ring-blue-500 focus:border-blue-500">
            <button id="login-submit" class="bg-blue-600 hover:bg-blue-700 text-white p-2 w-full rounded-md">登录</button>
        </div>
    </div>

    <div id="register-modal" class="fixed top-0 left-0 w-full h-full bg-gray-900 bg-opacity-50 hidden justify-center items-center">
        <div class="modal bg-white p-8 rounded-md shadow-lg w-96">
            <h2 class="text-2xl font-bold mb-4 text-center text-blue-600">注册</h2>
            <input type="text" id="register-username" placeholder="用户名" class="border border-gray-300 p-2 mb-2 w-full rounded-md focus:ring-blue-500 focus:border-blue-500">
            <input type="password" id="register-password" placeholder="密码" class="border border-gray-300 p-2 mb-2 w-full rounded-md focus:ring-blue-500 focus:border-blue-500">
            <button id="register-submit" class="bg-blue-600 hover:bg-blue-700 text-white p-2 w-full rounded-md">注册</button>
        </div>
    </div>

    <!-- 主内容区域 -->
    <div id="main-content" class="hidden p-4">
        <!-- 用户信息 -->
        <div class="flex items-center mb-4 bg-white p-4 rounded-md shadow-md">
            <img id="user-avatar" src="https://picsum.photos/50/50" alt="用户头像" class="w-10 h-10 rounded-full mr-2">
            <span id="username-display" class="text-lg font-bold text-blue-600">用户名</span>
            <button id="upload-avatar-btn" class="ml-4 bg-blue-600 hover:bg-blue-700 text-white p-2 rounded-md">上传头像</button>
            <input type="file" id="avatar-input" class="hidden">
        </div>

        <!-- 文件搜索 -->
        <input type="text" id="search-input" placeholder="搜索文件" class="border border-gray-300 p-2 mb-4 w-full rounded-md focus:ring-blue-500 focus:border-blue-500">

        <!-- 文件列表 -->
        <div id="file-list" class="bg-white p-4 rounded-md shadow-md">
            <!-- 文件项将通过 JavaScript 动态添加 -->
        </div>

        <!-- 文件上传 -->
        <div class="flex items-center space-x-4 mt-4">
            <input type="file" id="file-upload" class="border border-gray-300 p-2 rounded-md">
            <button id="upload-file-btn" class="bg-blue-600 hover:bg-blue-700 text-white p-2 rounded-md">上传文件</button>
        </div>
        <div id="upload-progress" class="progress-bar hidden mt-2">
            <div class="progress"></div>
        </div>

        <!-- 容量显示 -->
        <p id="capacity-display" class="mt-4 text-gray-600">已使用 0GB，总容量 1TB</p>

        <!-- 私聊功能 -->
        <div id="chat-section" class="mt-8 bg-white p-4 rounded-md shadow-md">
            <h2 class="text-2xl font-bold mb-4 text-blue-600">私聊</h2>
            <div id="chat-messages" class="border border-gray-300 p-2 h-48 overflow-y-auto mb-2 rounded-md">
                <!-- 聊天消息将通过 JavaScript 动态添加 -->
            </div>
            <div class="flex space-x-4">
                <input type="text" id="chat-input" placeholder="输入消息" class="border border-gray-300 p-2 w-3/4 rounded-md focus:ring-blue-500 focus:border-blue-500">
                <button id="send-chat-btn" class="bg-blue-600 hover:bg-blue-700 text-white p-2 w-1/4 rounded-md">发送</button>
            </div>
        </div>
    </div>

    <script>
        // 模拟用户数据
        const users = {};
        let currentUser = null;
        let usedCapacity = 0;
        const totalCapacity = 1024; // 1TB
        const maxFileSize = 100 * 1024 * 1024; // 100MB 文件大小限制
        const allowedFileTypes = ['image/jpeg', 'image/png', 'application/pdf', 'text/plain']; // 允许的文件类型

        // 显示登录模态框
        const loginBtn = document.getElementById('login-btn');
        const loginModal = document.getElementById('login-modal');
        loginBtn.addEventListener('click', () => {
            loginModal.classList.remove('hidden');
            loginModal.querySelector('.modal').classList.add('active');
        });

        // 显示注册模态框
        const registerBtn = document.getElementById('register-btn');
        const registerModal = document.getElementById('register-modal');
        registerBtn.addEventListener('click', () => {
            registerModal.classList.remove('hidden');
            registerModal.querySelector('.modal').classList.add('active');
        });

        // 关闭模态框
        const closeModals = () => {
            loginModal.classList.add('hidden');
            registerModal.classList.add('hidden');
            loginModal.querySelector('.modal').classList.remove('active');
            registerModal.querySelector('.modal').classList.remove('active');
        };

        // 注册功能
        const registerSubmit = document.getElementById('register-submit');
        registerSubmit.addEventListener('click', () => {
            const username = document.getElementById('register-username').value;
            const password = document.getElementById('register-password').value;
            if (username && password) {
                users[username] = { password, avatar: 'https://picsum.photos/50/50', files: [] };
                alert('注册成功，请登录');
                closeModals();
            }
        });

        // 登录功能
        const loginSubmit = document.getElementById('login-submit');
        loginSubmit.addEventListener('click', () => {
            const username = document.getElementById('login-username').value;
            const password = document.getElementById('login-password').value;
            if (users[username] && users[username].password === password) {
                currentUser = username;
                document.getElementById('username-display').textContent = currentUser;
                document.getElementById('user-avatar').src = users[currentUser].avatar;
                closeModals();
                document.getElementById('nav-actions').classList.add('hidden');
                document.getElementById('main-content').classList.remove('hidden');
            } else {
                alert('用户名或密码错误');
            }
        });

        // 上传头像
        const uploadAvatarBtn = document.getElementById('upload-avatar-btn');
        const avatarInput = document.getElementById('avatar-input');
        uploadAvatarBtn.addEventListener('click', () => {
            avatarInput.click();
        });
        avatarInput.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = (event) => {
                    users[currentUser].avatar = event.target.result;
                    document.getElementById('user-avatar').src = event.target.result;
                };
                reader.readAsDataURL(file);
            }
        });

        // 文件搜索
        const searchInput = document.getElementById('search-input');
        searchInput.addEventListener('input', () => {
            const query = searchInput.value.toLowerCase();
            const fileList = document.getElementById('file-list');
            const files = fileList.querySelectorAll('.file-item');
            files.forEach((file) => {
                const fileName = file.textContent.toLowerCase();
                if (fileName.includes(query)) {
                    file.style.display = 'block';
                } else {
                    file.style.display = 'none';
                }
            });
        });

        // 文件上传
        const fileUpload = document.getElementById('file-upload');
        const uploadFileBtn = document.getElementById('upload-file-btn');
        const uploadProgress = document.getElementById('upload-progress');
        const progressBar = uploadProgress.querySelector('.progress');
        uploadFileBtn.addEventListener('click', () => {
            const file = fileUpload.files[0];
            if (file) {
                if (file.size > maxFileSize) {
                    alert('文件大小超过限制（最大 50GB）');
                    return;
                }
                if (!allowedFileTypes.includes(file.type)) {
                    alert('不支持的文件类型');
                    return;
                }
                const fileSize = file.size / (1024 * 1024 * 1024); // 转换为 GB
                if (usedCapacity + fileSize <= totalCapacity) {
                    uploadProgress.classList.remove('hidden');
                    // 模拟上传进度
                    let progress = 0;
                    const interval = setInterval(() => {
                        if (progress >= 100) {
                            clearInterval(interval);
                            uploadProgress.classList.add('hidden');
                            usedCapacity += fileSize;
                            users[currentUser].files.push(file.name);
                            const fileList = document.getElementById('file-list');
                            const fileItem = document.createElement('div');
                            fileItem.classList.add('file-item', 'border', 'border-gray-300', 'p-2', 'mb-2', 'rounded-md');
                            fileItem.textContent = file.name;
                            fileList.appendChild(fileItem);
                            document.getElementById('capacity-display').textContent = `已使用 ${usedCapacity.toFixed(2)}GB，总容量 1TB`;
                        } else {
                            progress += 10;
                            progressBar.style.width = `${progress}%`;
                            progressBar.textContent = `${progress}%`;
                        }
                    }, 500);
                } else {
                    alert('容量不足');
                }
            }
        });

        // 私聊功能
        const chatInput = document.getElementById('chat-input');
        const sendChatBtn = document.getElementById('send-chat-btn');
        const chatMessages = document.getElementById('chat-messages');
        sendChatBtn.addEventListener('click', () => {
            const message = chatInput.value;
            if (message) {
                const messageItem = document.createElement('div');
                messageItem.textContent = `${currentUser}: ${message}`;
                chatMessages.appendChild(messageItem);
                chatInput.value = '';
            }
        });
    </script>
</body>

</html>
